/******************************************************************************
 * Includes
 *******************************************************************************/
#include "IgnitionControl.h"
#include "IO.h"
#include "tsk.h"
#include <stdint.h>

/******************************************************************************
 * Constants
 *******************************************************************************/

/******************************************************************************
 * Macros
 *******************************************************************************/
#define KILL_SWITCH_DEBOUNCE_NUMBER 10
/******************************************************************************
 * Configuration
 *******************************************************************************/

/******************************************************************************
 * Typedefs
 *******************************************************************************/

/******************************************************************************
 * Variable Declarations
 *******************************************************************************/
static uint8_t killSwitchDebouncer = 0;

/******************************************************************************
 * Function Prototypes
 *******************************************************************************/

/******************************************************************************
 * Function Definitions
 *******************************************************************************/

void IgnitionControl_Init(void) {
    killSwitchDebouncer = 0;
}

void IgnitionControl_Run_10ms(void) {
    if(IO_GET_KILL_SWITCH_IN() == 0){
        killSwitchDebouncer++;//go to sleep
    }
    if(killSwitchDebouncer >= 10){
        killSwitchDebouncer = 0;
        Tsk_Sleep();//go to sleep
    }
  
}

void IgnitionControl_Halt(void) {
    Nop();
}

/*** End of File **************************************************************/




